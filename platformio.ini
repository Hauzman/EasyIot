[platformio]
default_envs = ESP8266_RELEASE       
    

[extra]
version = 9.117
lib_deps =
    ArduinoJson
    ESPAsyncTCP
    ottowinter/ESPAsyncWebServer-esphome
    PubSubClient
    dht_nonblocking=https://github.com/brunohorta82/DHT_nonblocking.git
    DallasTemperature
    Arduino-Log=https://github.com/thijse/Arduino-Log.git
    ESP KNX IP Library=https://github.com/brunohorta82/esp-knx-ip.git
    PZEM004Tv30=https://github.com/mandulaj/PZEM-004T-v30.git
    AsyncMqttClient
    ArduinoModbus=https://github.com/4-20ma/ModbusMaster.git
    lennarthennigs/Button2@^2.2.4
    SHT4x=https://github.com/Sensirion/arduino-i2c-sht4x.git
    SSD1306=https://github.com/adafruit/Adafruit_SSD1306.git
    LTR303=https://github.com/brunohorta82/LTR303.git
default_flags= 
    -D VERSION=${extra.version} 
    -D CONFIG_LANG_PT
    -D MQTT_MAX_PACKET_SIZE=1000 
    -D ARDUINOJSON_ENABLE_INFINITY=1 
    -D NTP_SERVER='"pt.pool.ntp.org"' 
    -D TZ_INFO='"WET-0WEST-1,M3.5.0/01:00:00,M10.5.0/02:00:00"' 
    -D ATOMIC_FS_UPDATE 
    -D PIO_FRAMEWORK_ARDUINO_LWIP_HIGHER_BANDWIDTH 
    -D USE_ASYNC_UDP 
    -D WEB_SECURE_ON  
    -D REALM='"onofre"'
    -D DEBUG_ONOFRE
    -D LOW_POWER
    -D TEST_TEMPLATE
    -D LEGACY_PROVISON
    ;-D WIFI_SSID='"XXXXXXXX"'  
    ;-D WIFI_SECRET='"XXXXXXXX"'


[ESP32_8M]
platform = espressif32
board =  esp32dev
framework = arduino
board_build.flash_mode = qio
board_upload.flash_size  = 8MB
board_upload.maximum_size = 8388608
monitor_filters = esp32_exception_decoder 
monitor_speed=115200
extra_scripts = pre:tools/extra_script.py
build_flags =
    ${extra.default_flags} 
    -DDYNAMIC_JSON_DOCUMENT_SIZE=3000 
    -DBOARD_HAS_PSRAM 
lib_deps = ${extra.lib_deps}
        JustWifi=https://github.com/xoseperez/justwifi.git#esp32
board_build.partitions = partitions_custom.csv

[ESP32_4M]
platform = espressif32
board =  esp32dev
framework = arduino
board_build.flash_mode = qio
board_upload.flash_size  = 4MB
monitor_filters = esp32_exception_decoder 
monitor_speed=115200
extra_scripts = pre:tools/extra_script.py
build_flags =
    ${extra.default_flags} 
    -DDYNAMIC_JSON_DOCUMENT_SIZE=3000 
lib_deps = ${extra.lib_deps}
        JustWifi=https://github.com/xoseperez/justwifi.git#esp32


[env:ESP32_RELEASE]
extends = ESP32_8M
build_unflags=
    -D DEBUG_ONOFRE
    -D LOW_POWER
    -D TEST_TEMPLATE

[env:ESP32_TEST]
extends = ESP32_8M
build_unflags=
    -D WEB_SECURE_ON 
    -D LOW_POWER

[env:ESP32_4MB]
extends = ESP32_4M
build_unflags=
    -D WEB_SECURE_ON 
    -D LOW_POWER
    -D TEST_TEMPLATE

[env:ESP32_DEBUG]
extends = ESP32_8M
build_unflags=
    -D WEB_SECURE_ON 
    -D LOW_POWER
    -D TEST_TEMPLATE


[ESP8266]
platform = espressif8266
extra_scripts = pre:tools/extra_script.py
board = esp12e
framework = arduino
monitor_speed=115200
upload_speed=460800
board_build.flash_mode = dout
build_flags =${extra.default_flags} -D DYNAMIC_JSON_DOCUMENT_SIZE=2000
upload_resetmethod = nodemcu
monitor_filters = esp8266_exception_decoder
lib_deps = ${extra.lib_deps}
    JustWifi


[env:ESP8266_RELEASE]
extends = ESP8266
build_unflags=
    -D DEBUG_ONOFRE
    -D LOW_POWER
    -D TEST_TEMPLATE

[env:ESP8266_DEBUG]
extends = ESP8266
build_unflags=
    -D WEB_SECURE_ON
    -D LOW_POWER
    -D TEST_TEMPLATE
